<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="./images/favicon.png" type="image/png" />
    <title>Quay số trúng thưởng - KHASERVICE</title>
    <link rel="stylesheet" href="style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <canvas id="fallingCanvasMai"></canvas>
    <canvas id="fallingCanvasDao"></canvas>
    <!-- Hoa mai cố định ở góc phải -->
    <img id="img-mai" class="fixed-flower fixed-mai" alt="Hoa Mai" />

    <!-- Hoa đào cố định ở góc trái -->
    <img id="img-dao" class="fixed-flower fixed-dao" alt="Hoa Đào" />
    <div class="container">
      <audio id="audio-player"></audio>
      <audio id="audio-player1"></audio>
      <audio id="audio-player2" loop></audio>
      <div>
        <img
          alt="Logo"
          class="logo"
        />
        <h1
          style="
            font-family: 'Quicksand', sans-serif;
            color: #ffd700;
            font-size: 52px;
            font-weight: bold 700;
            margin: auto;
          "
        >
          Quay số trúng thưởng
        </h1>
        <h2
          class="price"
          style="font-family: 'Quicksand', sans-serif; color: #ffd700"
        ></h2>
        <!-- Tiêu đề giải thưởng -->
      </div>
      <div
        style="
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 20px;
        "
      >
        <div class="number-display">
          <div class="number" id="number1">0</div>
          <div class="number" id="number2">0</div>
          <div class="number" id="number3">0</div>
        </div>
        <div class="manual-spin-button">
          <button>QUAY</button>
        </div>
      </div>
      <div class="number-buttons">
        <button class="spin-small" data-prize="Giải đặc biệt" data-count="1">
          Giải đặc biệt
        </button>
        <button class="spin-small" data-prize="Giải nhất" data-count="1">
          Giải nhất
        </button>
        <button class="spin-small" data-prize="Giải nhì" data-count="3">
          Giải nhì
        </button>
        <button class="spin-small" data-prize="Giải ba" data-count="5">
          Giải ba
        </button>
        <button
          class="spin-small"
          data-prize="Giải KK"
          data-count="10"
        >
          Giải KK
        </button>
        <button class="spin-small" data-prize="Giải phụ" data-count="20">
          Giải phụ
        </button>
      </div>

      <div class="results">
        <h3>Danh sách kết quả đã quay:</h3>
        <ul id="result-list"></ul>
      </div>
    </div>
    <div id="settings-modal" class="modal hidden">
      <div class="settings-container">
        <!-- Sidebar -->
        <div class="settings-sidebar">
          <h2 style="text-align: center; color: #fff; margin-bottom: 20px;">Cài đặt</h2>
          <ul>
            <li class="active" data-tab="general">
              <a href="#">Chung</a>
            </li>
            <li data-tab="prizes">
              <a href="#">Giải thưởng</a>
            </li>
            <li data-tab="sound">
              <a href="#">Âm thanh</a>
            </li>
            <li data-tab="layout">
              <a href="#">Quay số</a>
            </li>
            <li data-tab="effects">
              <a href="#">Hiệu ứng</a>
            </li>
          </ul>
          <div class="sidebar-footer">
              <button id="close-settings-button" class="settings-button cancel">Đóng Cài Đặt</button>
          </div>
        </div>
        
        <!-- Content -->
        <div class="settings-content">
          <!-- General Settings -->
          <div id="general-settings" class="settings-tab active">
            <div class="tab-body">
              <h3>Tùy chỉnh chung</h3>
              <div id="branding-editor">
                <div class="setting-entry">
                  <label for="company-name-input">Tên công ty</label>
                  <input type="text" id="company-name-input" placeholder="Nhập tên công ty">
                </div>
                <div class="setting-entry-row" style="margin-bottom: 25px;">
                  <label for="hide-logo-checkbox" style="font-weight: 700; color: #4a5568;">Ẩn Logo</label>
                  <label class="switch">
                    <input type="checkbox" id="hide-logo-checkbox">
                    <span class="slider round"></span>
                  </label>
                </div>
                <div class="setting-entry">
                  <label for="logo-file-input">Tệp logo (dùng cho logo và favicon)</label>
                  <input type="file" id="logo-file-input" accept="image/png, image/jpeg, image/gif" class="custom-file-input">
                </div>
                 <div class="setting-entry">
                  <label for="info-image-input">Ảnh giới thiệu (GIF, JPG, PNG)</label>
                  <input type="file" id="info-image-input" accept="image/gif, image/jpeg, image/png" class="custom-file-input">
                </div>
                 <div class="setting-entry">
                  <label for="background-image-input">Ảnh nền</label>
                  <input type="file" id="background-image-input" accept="image/jpeg, image/png, image/gif" class="custom-file-input">
                </div>
              </div>
            </div>
            <div class="tab-footer">
              <button id="save-branding-button" class="settings-button save">Lưu thay đổi</button>
              <button id="show-info-modal-button" class="settings-button info-btn">Hiển thị lại ảnh giới thiệu</button>
            </div>
          </div>
          
          <!-- Prize Settings -->
          <div id="prizes-settings" class="settings-tab">
            <div class="tab-body">
              <h3>Cài đặt giải thưởng</h3>
              <div id="prize-list-editor">
                <!-- Prize entries will be dynamically inserted here -->
              </div>
            </div>
            <div class="tab-footer prize-footer">
              <button id="add-prize-button" class="settings-button add-btn">Thêm giải thưởng</button>
              <button id="reset-prizes-button" class="settings-button reset-btn">Đặt lại mặc định</button>
              <button id="save-prizes-button" class="settings-button save">Lưu giải thưởng</button>
            </div>
          </div>
          
          <!-- Sound Settings -->
          <div id="sound-settings" class="settings-tab">
            <div class="tab-body">
              <h3>Cài đặt âm thanh</h3>
              <div class="setting-entry">
                  <label>Âm thanh nền (Nhạc nền lặp lại)</label>
                  <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                    <button id="toggle-sound-button" class="settings-button" style="flex: 1;">Tắt âm thanh</button>
                    <button id="change-music-button" class="settings-button info-btn" style="flex: 1;">Chọn tệp nhạc</button>
                  </div>
                  <div class="setting-entry">
                    <label for="bg-volume-slider">Âm lượng nhạc nền: <span id="bg-volume-value">100</span>%</label>
                    <input type="range" id="bg-volume-slider" min="0" max="100" step="1" value="100" class="long-slider">
                  </div>
              </div>
              <hr style="border: 0; border-top: 1px solid #eee; margin: 20px 0;">
              <div class="setting-entry">
                  <label>Âm thanh khi quay/ra số (number.mp3)</label>
                  <input type="file" id="spin-sound-input" accept="audio/mp3, audio/wav" class="custom-file-input">
              </div>
              <div class="setting-entry">
                  <label>Âm thanh chúc mừng trúng thưởng (lucky-number.mp3)</label>
                  <input type="file" id="congrat-sound-input" accept="audio/mp3, audio/wav" class="custom-file-input">
              </div>
            </div>
            <div class="tab-footer">
              <button id="save-sounds-button" class="settings-button save">Lưu âm thanh</button>
            </div>
          </div>

          <!-- Spin Settings -->
          <div id="layout-settings" class="settings-tab">
            <div class="tab-body">
              <h3>Cấu hình thông số quay</h3>
              <div id="spin-config-editor">
                <div class="setting-entry">
                  <label for="digit-count-input">Số lượng chữ số (1-4)</label>
                  <input type="number" id="digit-count-input" min="1" max="4" value="3">
                </div>
                <div class="setting-entry">
                  <label for="stop-interval-input">Thời gian dừng giữa các ô (ms)</label>
                  <input type="number" id="stop-interval-input" min="500" max="5000" step="100" value="1200">
                </div>
                <div class="setting-entry">
                  <label for="result-display-time-input">Thời gian hiện kết quả chúc mừng (giây)</label>
                  <input type="number" id="result-display-time-input" min="1" max="30" value="5">
                </div>
                <div class="setting-row">
                  <div class="setting-entry">
                      <label for="min-value-input">Giá trị nhỏ nhất</label>
                      <input type="number" id="min-value-input" min="0" value="0">
                  </div>
                  <div class="setting-entry">
                      <label for="max-value-input">Giá trị lớn nhất</label>
                      <input type="number" id="max-value-input" min="1" value="999">
                  </div>
                </div>
                <div class="setting-entry-row">
                  <label for="allow-duplicate-checkbox">Cho phép trùng số đã trúng</label>
                  <label class="switch">
                    <input type="checkbox" id="allow-duplicate-checkbox">
                    <span class="slider round"></span>
                  </label>
                </div>
              </div>
            </div>
            <div class="tab-footer">
              <button id="save-spin-config-button" class="settings-button save">Lưu cấu hình</button>
              <button id="reset-spin-config-button" class="settings-button reset-btn">Đặt lại</button>
            </div>
          </div>

          <!-- Effects Settings -->
          <div id="effects-settings" class="settings-tab">
            <div class="tab-body">
              <h3>Cài đặt hiệu ứng</h3>
              <div id="effects-editor">
                <div class="setting-entry-row">
                  <label for="toggle-flowers-checkbox">Hiệu ứng hoa rơi</label>
                  <label class="switch">
                    <input type="checkbox" id="toggle-flowers-checkbox">
                    <span class="slider round"></span>
                  </label>
                </div>
                <div class="setting-entry-row">
                  <label for="toggle-fixed-flowers-checkbox">Hoa cố định (Góc màn hình)</label>
                  <label class="switch">
                    <input type="checkbox" id="toggle-fixed-flowers-checkbox" checked>
                    <span class="slider round"></span>
                  </label>
                </div>
                <div class="setting-entry">
                  <label for="flower-speed-slider">Tốc độ rơi (hiện tại: <span id="flower-speed-value">1</span>)</label>
                  <input type="range" id="flower-speed-slider" min="0.1" max="5" step="0.1" value="1" class="long-slider">
                </div>
                <div class="setting-entry-row">
                  <label for="toggle-fireworks-checkbox">Hiệu ứng pháo hoa</label>
                   <label class="switch">
                    <input type="checkbox" id="toggle-fireworks-checkbox">
                    <span class="slider round"></span>
                  </label>
                </div>
                <div class="setting-entry">
                  <label>Kiểu pháo hoa</label>
                  <div id="firework-style-cards" class="card-select-container">
                    <!-- Các thẻ kiểu pháo hoa sẽ được chèn động từ script.js -->
                  </div>
                </div>
              </div>
            </div>
            <div class="tab-footer">
              <button id="save-effects-button" class="settings-button save">Lưu hiệu ứng</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal -->
    <div id="notification-modal" class="modal hidden">
      <div class="modal-content">
        <p id="modal-message"></p>
        <button id="close-modal">OK</button>
      </div>
    </div>

    <canvas id="canvas"></canvas>
    <script src="./js/FireworkEngine.js"></script>
    <script src="./js/SpinEngine.js"></script>
    <script src="./js/UIManager.js"></script>
    <script src="./script.js"></script>
    <div id="infoModal" class="modal-info">
      <div class="modal-info-content">
        <img alt="Welcome Animation" />
      </div>
    </div>

    <div id="congratulationsModal" class="modal-info-congrat">
      <div class="modal-info-content-congrat">
        <!-- <img src="./images/congrat.png" alt="Congratulations Image" class="congrat-img" /> -->
        <img
          id="img-congrat"
          alt="Congrat Animation"
          class="congrat-img"
        />
        <div id="lucky-number-display" class="lucky-number">000</div>
      </div>
    </div>

    <script>
      // Lấy modal
      const infoModal = document.getElementById("infoModal");

      // Đóng modal khi bấm ra ngoài
      infoModal.addEventListener("click", function (e) {
        if (e.target === infoModal) {
          infoModal.classList.add("hidden"); // Thêm lớp hidden để ẩn modal
        }
      });

      // Hiển thị modal khi trang được tải
      window.addEventListener("load", function () {
        infoModal.classList.remove("hidden");
      });
    </script>
  </body>
</html>
